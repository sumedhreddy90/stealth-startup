{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/sumedhreddy/Documents/stealth/stealth-startup/src/context/AuthenticationContext.tsx\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport axios from \"axios\";\nimport React, { useState, Children, useEffect } from \"react\";\nimport { AsyncStorage } from \"react-native-web/dist/index\";\nexport var AuthenticationContext = React.createContext({\n  isLoggedIn: false,\n  user: undefined,\n  login: function login(_) {\n    return Promise.resolve(false);\n  },\n  logout: function logout() {\n    return Promise.resolve(false);\n  }\n});\nexport var AuthenticationProvider = function AuthenticationProvider(props) {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var login = function login(user) {\n    return _regeneratorRuntime.async(function login$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"AccessToken\"));\n\n          case 2:\n            _context.t0 = _context.sent;\n            axios.defaults.headers[\"Authorization\"] = \"Bearer \" + _context.t0;\n            setUser(user);\n            return _context.abrupt(\"return\", Promise.resolve(true));\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var logout = function logout() {\n    return _regeneratorRuntime.async(function logout$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.multiRemove([\"AccessToken\", \"User\"]));\n\n          case 2:\n            axios.defaults.headers[\"Authorization\"] = null;\n            setUser(undefined);\n            return _context2.abrupt(\"return\", Promise.resolve(true));\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    setUser(props.user);\n  }, [props.user]);\n  return React.createElement(AuthenticationContext.Provider, {\n    value: {\n      login: login,\n      logout: logout,\n      user: user,\n      isLoggedIn: !!user\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 5\n    }\n  }, Children.only(props.children));\n};","map":{"version":3,"sources":["/Users/sumedhreddy/Documents/stealth/stealth-startup/src/context/AuthenticationContext.tsx"],"names":["axios","React","useState","Children","useEffect","AsyncStorage","AuthenticationContext","createContext","isLoggedIn","user","undefined","login","_","Promise","resolve","logout","AuthenticationProvider","props","setUser","getItem","defaults","headers","multiRemove","only","children"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,EAA0BC,QAA1B,EAAoCC,SAApC,QAAqD,OAArD;SACSC,Y;AAWT,OAAO,IAAMC,qBAAqB,GAAGL,KAAK,CAACM,aAAN,CAEnC;AACAC,EAAAA,UAAU,EAAE,KADZ;AAEAC,EAAAA,IAAI,EAAEC,SAFN;AAGAC,EAAAA,KAAK,EAAE,eAACC,CAAD;AAAA,WAAkBC,OAAO,CAACC,OAAR,CAAgB,KAAhB,CAAlB;AAAA,GAHP;AAIAC,EAAAA,MAAM,EAAE;AAAA,WAAMF,OAAO,CAACC,OAAR,CAAgB,KAAhB,CAAN;AAAA;AAJR,CAFmC,CAA9B;AASP,OAAO,IAAME,sBAAsD,GAAG,SAAzDA,sBAAyD,CACpEC,KADoE,EAEjE;AACH,kBAAwBf,QAAQ,EAAhC;AAAA;AAAA,MAAOO,IAAP;AAAA,MAAaS,OAAb;;AAEA,MAAMP,KAAK,GAAG,SAARA,KAAQ,CAAOF,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CAESJ,YAAY,CAACc,OAAb,CAAqB,aAArB,CAFT;;AAAA;AAAA;AACZnB,YAAAA,KAAK,CAACoB,QAAN,CAAeC,OAAf,CAAuB,eAAvB,CADY,GAEV,SAFU;AAGZH,YAAAA,OAAO,CAACT,IAAD,CAAP;AAHY,6CAILI,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAJK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAd;;AAOA,MAAMC,MAAM,GAAG,SAATA,MAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CACPV,YAAY,CAACiB,WAAb,CAAyB,CAAC,aAAD,EAAgB,MAAhB,CAAzB,CADO;;AAAA;AAEbtB,YAAAA,KAAK,CAACoB,QAAN,CAAeC,OAAf,CAAuB,eAAvB,IAA0C,IAA1C;AACAH,YAAAA,OAAO,CAACR,SAAD,CAAP;AAHa,8CAING,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAJM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAOAV,EAAAA,SAAS,CAAC,YAAM;AACdc,IAAAA,OAAO,CAACD,KAAK,CAACR,IAAP,CAAP;AACD,GAFQ,EAEN,CAACQ,KAAK,CAACR,IAAP,CAFM,CAAT;AAIA,SACE,oBAAC,qBAAD,CAAuB,QAAvB;AACE,IAAA,KAAK,EAAE;AAAEE,MAAAA,KAAK,EAALA,KAAF;AAASI,MAAAA,MAAM,EAANA,MAAT;AAAiBN,MAAAA,IAAI,EAAEA,IAAvB;AAA6BD,MAAAA,UAAU,EAAE,CAAC,CAACC;AAA3C,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGGN,QAAQ,CAACoB,IAAT,CAAcN,KAAK,CAACO,QAApB,CAHH,CADF;AAOD,CA9BM","sourcesContent":["import axios from \"axios\";\nimport React, { useState, Children, useEffect } from \"react\";\nimport { AsyncStorage } from \"react-native\";\n\nimport { UserModel } from \"../models\";\n\nexport type AuthenticationContextType = {\n  isLoggedIn: boolean;\n  user?: UserModel;\n  login: (user: UserModel) => Promise<boolean>;\n  logout: () => Promise<boolean>;\n};\n\nexport const AuthenticationContext = React.createContext<\n  AuthenticationContextType\n>({\n  isLoggedIn: false,\n  user: undefined,\n  login: (_: UserModel) => Promise.resolve(false),\n  logout: () => Promise.resolve(false),\n});\n\nexport const AuthenticationProvider: React.FC<{ user?: UserModel }> = (\n  props\n) => {\n  const [user, setUser] = useState<UserModel>();\n\n  const login = async (user: UserModel) => {\n    axios.defaults.headers[\"Authorization\"] =\n      \"Bearer \" + (await AsyncStorage.getItem(\"AccessToken\"));\n    setUser(user);\n    return Promise.resolve(true);\n  };\n\n  const logout = async () => {\n    await AsyncStorage.multiRemove([\"AccessToken\", \"User\"]);\n    axios.defaults.headers[\"Authorization\"] = null;\n    setUser(undefined);\n    return Promise.resolve(true);\n  };\n\n  useEffect(() => {\n    setUser(props.user);\n  }, [props.user]);\n\n  return (\n    <AuthenticationContext.Provider\n      value={{ login, logout, user: user, isLoggedIn: !!user }}\n    >\n      {Children.only(props.children)}\n    </AuthenticationContext.Provider>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}